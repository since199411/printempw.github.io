<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />


<meta name="theme-color" content="#3C8DBC">
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="HandheldFriendly" content="True" />


<meta name="description" content="è¿™é‡Œæ˜¯ @printempw çš„ä¸ªäººåšå®¢ï¼ŒåŸºæœ¬ä¸Šå•¥éƒ½å†™ï¼šå¼€å‘å¿ƒå¾—åˆ†äº«ï¼Œæ—¥å¸¸åæ§½å¹é€¼ï¼Œå¶å°”ä¹Ÿä¼šå†™æ­£ç»æ–‡å­—ï¼Œæ¬¢è¿è®¢é˜…ã€‚" />

  <meta name="keywords" content="Nginx,PHP,Apache," />




<meta name="google-site-verification" content="WUNRfYChNMDduwLOFHG41TsVrre6BOaI7jKshEvtRts" />



<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">


<meta name="generator" content="Hexo" />


<meta name="description" content="çœ‹åˆ°è¿™ä¸ªæ ‡é¢˜ï¼Œæœ‰äººå¯èƒ½ä¼šæƒ³åæ§½ï¼š ä½ ä»–å¨˜çš„å†™äº†è¿™ä¹ˆä¹… PHPï¼Œæ€ä¹ˆç°åœ¨æƒ³èµ·æ¥æ­å»ºå¼€å‘ç¯å¢ƒäº†ï¼Ÿ å‘ƒï¼Œæƒ…å†µå‘¢æ˜¯è¿™ä¹ˆä¸ªæƒ…å†µï¼Œæˆ‘ä¹‹å‰å¼€å‘çš„é‚£ä¸ª PHP é¡¹ç›® (printempw/blessing-skin-server) åœ¨ä¸¤ä¸ªæœˆå‰å‘å¸ƒ v3.5.0 ç‰ˆæœ¬ååŸºæœ¬å°±å·²ç»å‘Šä¸€æ®µè½äº†ã€‚è™½ç„¶æˆ‘æœ¬æ„æ˜¯ä¸å†æ›´æ–°ï¼ˆå¼ƒå‘çš„å§”å©‰è¯´æ³•ï¼‰ï¼Œå› ä¸ºå½“å‰çš„ç‰ˆæœ¬å·²ç»è¶³å¤Ÿå®Œå–„ï¼Œè¯¥æœ‰çš„ä¸œè¥¿éƒ½æœ‰äº†ï¼ˆè€Œä¸”è¯´å®è¯æäº†è¿™ä¹ˆä¹…æˆ‘ä¹Ÿè…»å‘³ï¼Œä¸ä»…æ˜¯å¯¹è¿™">
<meta name="keywords" content="Nginx,PHP,Apache">
<meta property="og:type" content="article">
<meta property="og:title" content="Windows ä¸‹æ‰‹åŠ¨æ­å»º PHP + Nginx&#x2F;Apache å¼€å‘ç¯å¢ƒ">
<meta property="og:url" content="https://blessing.studio/setup-nginx-php-on-windows/index.html">
<meta property="og:site_name" content="Blessing Studio">
<meta property="og:description" content="çœ‹åˆ°è¿™ä¸ªæ ‡é¢˜ï¼Œæœ‰äººå¯èƒ½ä¼šæƒ³åæ§½ï¼š ä½ ä»–å¨˜çš„å†™äº†è¿™ä¹ˆä¹… PHPï¼Œæ€ä¹ˆç°åœ¨æƒ³èµ·æ¥æ­å»ºå¼€å‘ç¯å¢ƒäº†ï¼Ÿ å‘ƒï¼Œæƒ…å†µå‘¢æ˜¯è¿™ä¹ˆä¸ªæƒ…å†µï¼Œæˆ‘ä¹‹å‰å¼€å‘çš„é‚£ä¸ª PHP é¡¹ç›® (printempw/blessing-skin-server) åœ¨ä¸¤ä¸ªæœˆå‰å‘å¸ƒ v3.5.0 ç‰ˆæœ¬ååŸºæœ¬å°±å·²ç»å‘Šä¸€æ®µè½äº†ã€‚è™½ç„¶æˆ‘æœ¬æ„æ˜¯ä¸å†æ›´æ–°ï¼ˆå¼ƒå‘çš„å§”å©‰è¯´æ³•ï¼‰ï¼Œå› ä¸ºå½“å‰çš„ç‰ˆæœ¬å·²ç»è¶³å¤Ÿå®Œå–„ï¼Œè¯¥æœ‰çš„ä¸œè¥¿éƒ½æœ‰äº†ï¼ˆè€Œä¸”è¯´å®è¯æäº†è¿™ä¹ˆä¹…æˆ‘ä¹Ÿè…»å‘³ï¼Œä¸ä»…æ˜¯å¯¹è¿™">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://img.blessing.studio/images/2018/11/01/php-cgi-processes.png">
<meta property="og:image" content="https://img.blessing.studio/images/2018/11/01/nginx-php-works.png">
<meta property="og:image" content="https://img.blessing.studio/images/2018/11/01/wnmp-all-processes.png">
<meta property="og:updated_time" content="2018-11-01T15:00:10.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Windows ä¸‹æ‰‹åŠ¨æ­å»º PHP + Nginx&#x2F;Apache å¼€å‘ç¯å¢ƒ">
<meta name="twitter:description" content="çœ‹åˆ°è¿™ä¸ªæ ‡é¢˜ï¼Œæœ‰äººå¯èƒ½ä¼šæƒ³åæ§½ï¼š ä½ ä»–å¨˜çš„å†™äº†è¿™ä¹ˆä¹… PHPï¼Œæ€ä¹ˆç°åœ¨æƒ³èµ·æ¥æ­å»ºå¼€å‘ç¯å¢ƒäº†ï¼Ÿ å‘ƒï¼Œæƒ…å†µå‘¢æ˜¯è¿™ä¹ˆä¸ªæƒ…å†µï¼Œæˆ‘ä¹‹å‰å¼€å‘çš„é‚£ä¸ª PHP é¡¹ç›® (printempw/blessing-skin-server) åœ¨ä¸¤ä¸ªæœˆå‰å‘å¸ƒ v3.5.0 ç‰ˆæœ¬ååŸºæœ¬å°±å·²ç»å‘Šä¸€æ®µè½äº†ã€‚è™½ç„¶æˆ‘æœ¬æ„æ˜¯ä¸å†æ›´æ–°ï¼ˆå¼ƒå‘çš„å§”å©‰è¯´æ³•ï¼‰ï¼Œå› ä¸ºå½“å‰çš„ç‰ˆæœ¬å·²ç»è¶³å¤Ÿå®Œå–„ï¼Œè¯¥æœ‰çš„ä¸œè¥¿éƒ½æœ‰äº†ï¼ˆè€Œä¸”è¯´å®è¯æäº†è¿™ä¹ˆä¹…æˆ‘ä¹Ÿè…»å‘³ï¼Œä¸ä»…æ˜¯å¯¹è¿™">
<meta name="twitter:image" content="https://img.blessing.studio/images/2018/11/01/php-cgi-processes.png">
<meta name="twitter:creator" content="@printempw">





  <link rel="alternate" href="/atom.xml" title="Blessing Studio">



  <link rel="canonical" href="https://blessing.studio/setup-nginx-php-on-windows/"/>



<link rel="shortcut icon" href="/images/favicon.ico">
<link rel="icon" sizes="192x192" href="/images/icon.png" />
<link rel="apple-touch-icon" sizes="144x144" href="/images/touch-icon.png" />


<link rel="stylesheet" href="/css/main.css">
<link rel="stylesheet" href="/libs/fancybox/source/jquery.fancybox.css">
<link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css">


<link rel="stylesheet" type="text/css" href="https://fonts.cat.net/css?family=Alegreya" />
<link rel="stylesheet" type="text/css" href="https://fonts.cat.net/css?family=Alegreya+SC" />
<link rel="stylesheet" type="text/css" href="https://fonts.cat.net/css?family=Roboto+Slab">
<link rel="stylesheet" type="text/css" href="https://fonts.cat.net/css?family=PT+Serif">


    <title>Windows ä¸‹æ‰‹åŠ¨æ­å»º PHP + Nginx/Apache å¼€å‘ç¯å¢ƒ - Blessing Studio</title>
  </head>

  <body lang="zh-CN">

    <div id="pageframe" class="fw">
      <script type="text/javascript" src="/js/nanobar.js"></script>
<script type="text/javascript">
    /* Initial NanoBar */
    var nanobar = new Nanobar({
        bg: "#BEDBEC",
        target: document.getElementById("pageframe"),
        id: "inb"
    });
</script>


      <div id="top" class="fw clf">
        <div id="header" class="wc center">
  <div class="logo-container left">
    
    <div class="logo left">
      <a href="https://blessing.studio"><img src="/images/logo.png"></a>
    </div>
  </div>

  <div class="social right">
    
    <div class="ico right" id="tg-s"><a href="javascript:void()" class="fa fa-search"></a></div>
    <form role="search" method="get" id="searchform-top" action="https://www.google.com/search">
      <input type="hidden" name="sitesearch" value="https://blessing.studio">
      <input type="text" name="q" id="s-top" placeholder="æœä¸€æœ (ã‚Ï‰Â·)â˜† " />
    </form>

    
    <div id="toggler" class="right">
      
        
          <div class="ico">
            <a href="https://twitter.com/printempw" target="_blank" title="Twitter" class="fa fa-twitter"></a>
          </div>
        
          <div class="ico">
            <a href="https://github.com/printempw" target="_blank" title="GitHub" class="fa fa-github"></a>
          </div>
        
      
      <div class="ico">
        <a href="/atom.xml" target="_blank" class="fa fa-rss" ></a>
      </div>
    </div>

    <div class="ico right" id="tg-m"><a href="javascript:;" class="fa fa-bars"></a></div>
  </div>

  <div class="topmenu left">
    <div class="menu-container">
      <ul class="menu">
  
    
    <li class="menu-item menu-item-tech">
      <a href="/categories/tech/" title="æé«˜å§¿åŠ¿æ°´å¹³" rel="section">
      æŠ€æœ¯
      </a>
    </li>
  
    
    <li class="menu-item menu-item-archive">
      <a href="/archives/" title="æ€»è§ˆå†å²æ–‡ç« " rel="section">
      å½’æ¡£
      </a>
    </li>
  
    
    <li class="menu-item menu-item-kaomoji">
      <a href="javascript:void;" title="ç‚¹æˆ‘ç‚¹æˆ‘" rel="section">
      (Â´ãƒ»Ï‰ãƒ»`)
      </a>
    </li>
  
</ul>

    </div>
  </div>
  <div class="left clf"></div>

</div>

      </div>

      <div id="container" class="wc center clf page-post">
        <script type="text/javascript">nanobar.go(20);</script>

        <div id="content" class="wp">
          

  
  <article class="post post-type-normal hentry">
    <h1 class="post-title">
      <a href="/setup-nginx-php-on-windows/">Windows ä¸‹æ‰‹åŠ¨æ­å»º PHP + Nginx/Apache å¼€å‘ç¯å¢ƒ</a>
    </h1>

    






    <div class="post-content">
      
      <div class="toc-container">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#0x01-å®‰è£…-Nginx-Apache"><span class="toc-text">0x01 å®‰è£… Nginx / Apache</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x02-å®‰è£…-PHP"><span class="toc-text">0x02 å®‰è£… PHP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x03-é…ç½®-FastCGI-è½¬å‘"><span class="toc-text">0x03 é…ç½® FastCGI è½¬å‘</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x04-ç¼–å†™å¯åœè„šæœ¬"><span class="toc-text">0x04 ç¼–å†™å¯åœè„šæœ¬</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x05-åè®°"><span class="toc-text">0x05 åè®°</span></a></li></ol>
      </div>
      
      <p>çœ‹åˆ°è¿™ä¸ªæ ‡é¢˜ï¼Œæœ‰äººå¯èƒ½ä¼šæƒ³åæ§½ï¼š</p>
<p><strong>ä½ ä»–å¨˜çš„å†™äº†è¿™ä¹ˆä¹… PHPï¼Œæ€ä¹ˆç°åœ¨æƒ³èµ·æ¥æ­å»ºå¼€å‘ç¯å¢ƒäº†ï¼Ÿ</strong></p>
<p>å‘ƒï¼Œæƒ…å†µå‘¢æ˜¯è¿™ä¹ˆä¸ªæƒ…å†µï¼Œæˆ‘ä¹‹å‰å¼€å‘çš„é‚£ä¸ª PHP é¡¹ç›® (<a href="https://github.com/printempw/blessing-skin-server/" target="_blank" rel="noopener">printempw/blessing-skin-server</a>) åœ¨ä¸¤ä¸ªæœˆå‰å‘å¸ƒ v3.5.0 ç‰ˆæœ¬ååŸºæœ¬å°±å·²ç»å‘Šä¸€æ®µè½äº†ã€‚è™½ç„¶æˆ‘æœ¬æ„æ˜¯ä¸å†æ›´æ–°<del>ï¼ˆå¼ƒå‘çš„å§”å©‰è¯´æ³•ï¼‰</del>ï¼Œå› ä¸ºå½“å‰çš„ç‰ˆæœ¬å·²ç»è¶³å¤Ÿå®Œå–„ï¼Œè¯¥æœ‰çš„ä¸œè¥¿éƒ½æœ‰äº†ï¼ˆè€Œä¸”è¯´å®è¯æäº†è¿™ä¹ˆä¹…æˆ‘ä¹Ÿè…»å‘³ï¼Œä¸ä»…æ˜¯å¯¹è¿™ä¸ªç¨‹åºï¼Œè¿˜æœ‰å¯¹å›½å†… Minecraft å¼€å‘ç”Ÿæ€ä»¥åŠç”¨æˆ·ç¾¤ä½“çš„å¤±æœ›ï¼‰ã€‚</p>
<p>ä¸è¿‡æˆ‘çš„æœ‹å‹ <a href="https://blog.gplane.win/" target="_blank" rel="noopener">g-plane</a> è¯´ä»–æ„¿æ„æ¥å‘ï¼Œæ‰€ä»¥ç°åœ¨è¿™ä¸ªé¡¹ç›®çš„åç»­å¼€å‘éƒ½æ˜¯ä»–åœ¨æã€‚è€Œæˆ‘ä¹Ÿä¹å¾—æ¸…é—²ï¼Œåšä¸ªç”©æ‰‹æŒæŸœ <a href="https://blessing.studio/vscode-c-cpp-configuration-for-acm-oj/">æåˆ«çš„</a> å»äº†ã€‚å½“æˆ‘æ‘¸é±¼æ­£å¿«æ´»æ—¶ï¼Œä»–è¿‡æ¥è”ç³»æˆ‘è¯´å‡†å¤‡å‘å¸ƒ 4.0.0-alpha äº†ï¼Œæˆ‘æ‰æƒ³èµ·æ¥è¿™èŒ¬ï¼šã€Œå•Šï¼Œæˆ‘è¿æ–°ç‰ˆæœ¬é•¿å•¥æ ·éƒ½è¿˜ä¸çŸ¥é“å‘¢ï¼ğŸ˜‚ã€äºæ˜¯æ€¥æ€¥å¿™å¿™ pull äº†æ–°ä»£ç å‡†å¤‡ review ä¸€ä¸‹ï¼Œå´å‘ç°æˆ‘çš„æ–°ç¬”ç”µä¸Šç”šè‡³å‹æ ¹å„¿å°±æ²¡å®‰è£… PHP å¼€å‘ç¯å¢ƒï¼Œåªèƒ½è¯´æ˜¯éå¸¸åœ°çœŸå®ã€‚</p>
<p>å› ä¸º <a href="https://blessing.studio/phpstudy-prober-page-502-bad-gateway/">æŸäº›åŸå› </a>ï¼Œæˆ‘ä¸æƒ³ç»§ç»­ä½¿ç”¨é‚£äº› PHP ä¸€é”®åŒ…æ¥æ­å»ºå¼€å‘ç¯å¢ƒäº†ï¼Œæ‰€ä»¥è¿™æ¬¡æˆ‘æ‰“ç®—å…¨éƒ¨è‡ªå·±æ¥ã€‚æœ¬æ–‡è®°å½•äº†æˆ‘æ‰‹åŠ¨å®‰è£…é…ç½® PHP + Nginx/Apache å¼€å‘ç¯å¢ƒçš„è¿‡ç¨‹ï¼Œå¸Œæœ›èƒ½å¸®åˆ°åæ¥äººã€‚</p>
<p>æ³¨æ„ï¼Œæœ¬æ–‡ä¸­çš„é…ç½®é€‚ç”¨äºæœ¬åœ°å¼€å‘ç¯å¢ƒï¼Œåº”ç”¨è‡³ç”Ÿäº§ç¯å¢ƒæ—¶è¦æ³¨æ„å“¦ã€‚</p>
<a id="more"></a>
<h2 id="0x01-å®‰è£…-Nginx-Apache"><a href="#0x01-å®‰è£…-Nginx-Apache" class="headerlink" title="0x01 å®‰è£… Nginx / Apache"></a>0x01 å®‰è£… Nginx / Apache</h2><p><strong>å¦‚æœä½ ç”¨çš„æ˜¯ Nginxï¼š</strong></p>
<ul>
<li>å» <a href="https://nginx.org/en/download.html" target="_blank" rel="noopener">å®˜ç½‘</a> ä¸‹è½½ Windows ç‰ˆçš„ Nginxï¼ˆæˆ‘ä¸‹è½½çš„æ˜¯ <code>nginx-1.14.0.zip</code>ï¼‰ï¼›</li>
<li>è§£å‹è‡³ä½ å–œæ¬¢çš„åœ°æ–¹ï¼ˆæˆ‘æ”¾åœ¨ <code>E:\environment\nginx</code> é‡Œï¼‰ï¼›</li>
<li>ç›´æ¥åŒå‡»è¿è¡Œ <code>nginx.exe</code>ï¼›</li>
<li>å¦‚æœèƒ½æ­£å¸¸è®¿é—® <code>http://localhost:80</code>ï¼Œå°±å¯ä»¥è¿›è¡Œä¸‹ä¸€æ­¥äº†ã€‚</li>
</ul>
<p>æ¨èä¿®æ”¹çš„ <code>nginx.conf</code> é…ç½®å¦‚ä¸‹ï¼š</p>
<pre><code class="nginx"># å¯ä»¥é€‚å½“è°ƒé«˜ï¼Œä½†ä¸è¦è¶…è¿‡ CPU æ ¸å¿ƒæ•°é‡
worker_processes  4;

events {
    # å¼€å‘ç¯å¢ƒä¸‹ä¸ç”¨å¤ªè€ƒè™‘ worker æœ€å¤§å¹¶å‘è¿æ¥æ•°
    worker_connections  1024;
}

http {
    include       mime.types;
    default_type  application/octet-stream;
    sendfile      on;
    keepalive_timeout 65;

    # å¯ç”¨ gzip
    gzip on;
    gzip_disable &quot;MSIE [1-6].(?!.*SV1)&quot;;
    gzip_http_version 1.1;
    gzip_vary on;
    gzip_proxied any;
    gzip_min_length 1000;
    gzip_buffers 16 8k;
    gzip_comp_level 6;
    gzip_types text/plain text/css text/xml text/javascript application/json application/x-javascript application/xml application/xml+rss;

    # è¿™é‡Œé¢çš„å†…å®¹ç­‰ 0x03 å†ç»†è¯´
    include vhosts.conf;
}
</code></pre>
<p><strong>å¦‚æœä½ ç”¨çš„æ˜¯ Apacheï¼š</strong></p>
<ul>
<li>å› ä¸º Apache å®˜ç½‘å¹¶ä¸æä¾› Windows ç‰ˆçš„æ„å»ºä¸‹è½½ï¼Œæ‰€ä»¥éœ€è¦å» <a href="https://www.apachelounge.com/download/" target="_blank" rel="noopener">Apache Lounge</a> æˆ–è€…å…¶ä»– <a href="https://httpd.apache.org/docs/current/platform/windows.html#down" target="_blank" rel="noopener">å®˜æ–¹æ¨èçš„ç«™ç‚¹</a> ä¸‹è½½é¢„ç¼–è¯‘äºŒè¿›åˆ¶åŒ…ï¼ˆæˆ‘ä¸‹è½½çš„æ˜¯ <code>httpd-2.4.37-win64-VC15.zip</code>ï¼Œä½ æ„¿æ„çš„è¯ä¹Ÿå¯ä»¥è‡ªå·±ç¼–è¯‘ï¼‰ï¼›</li>
<li>è§£å‹è‡³ä½ å–œæ¬¢çš„åœ°æ–¹ï¼ˆæˆ‘æ”¾åœ¨ <code>E:\environment\apache</code> é‡Œï¼‰ï¼›</li>
<li>ç›´æ¥åŒå‡»è¿è¡Œ <code>bin/httpd.exe</code>ï¼›</li>
<li>å¦‚æœèƒ½æ­£å¸¸è®¿é—® <code>http://localhost:80</code>ï¼Œå°±å¯ä»¥è¿›è¡Œä¸‹ä¸€æ­¥äº†ã€‚</li>
</ul>
<p>æ¨èä¿®æ”¹çš„ <code>httpd.conf</code> é…ç½®å¦‚ä¸‹ï¼š</p>
<pre><code class="apache"># ä¿®æ”¹ä¸ºä½ çš„å®‰è£…ç›®å½•
Define SRVROOT &quot;E:\environment\apache&quot;
ServerRoot &quot;${SRVROOT}&quot;

Listen 80
ServerName localhost

# æŒ‰éœ€å¯ç”¨æ¨¡å—
LoadModule rewrite_module modules/mod_rewrite.so
LoadModule ...

# æ¨èæ³¨é‡Šæ‰è‡ªå¸¦çš„ DocumentRoot å’Œ &lt;Directory&gt;
# è¿™é‡Œé¢çš„å†…å®¹ç­‰ 0x03 å†ç»†è¯´
Include conf/extra/httpd-php.conf
Include conf/vhosts.conf
</code></pre>
<h2 id="0x02-å®‰è£…-PHP"><a href="#0x02-å®‰è£…-PHP" class="headerlink" title="0x02 å®‰è£… PHP"></a>0x02 å®‰è£… PHP</h2><p>Windows ç‰ˆ PHP ä¸‹è½½åœ°å€ï¼š</p>
<p><a href="https://windows.php.net/download" target="_blank" rel="noopener">https://windows.php.net/download</a></p>
<p>å…¶ä¸­æœ‰ NTSï¼ˆNon Thread Safeï¼Œéçº¿ç¨‹å®‰å…¨ï¼‰å’Œ TSï¼ˆThread Safeï¼Œçº¿ç¨‹å®‰å…¨ï¼‰ä¸¤ç§ç‰ˆæœ¬ï¼Œç®€å•æ¥è¯´å°±æ˜¯ <strong>Nginx ç”¨ NTS ç‰ˆï¼ŒApache é€šå¸¸ç”¨ TS ç‰ˆ</strong>ï¼ˆä¹Ÿå¯ä»¥ç”¨ NTSï¼‰ï¼Œå®ƒä»¬ä¹‹é—´çš„å…·ä½“åŒºåˆ«æœ‰å…´è¶£çš„è¯å¯ä»¥è‡ªå·±å»äº†è§£ä¸€ä¸‹ã€‚</p>
<p>ä¸ºäº†åŒæ—¶å…¼å®¹ Nginx ä¸ Apacheï¼Œæœ¬æ–‡å°†ä»¥ NTS ç‰ˆä¸ºä¾‹è¿›è¡Œé…ç½®ã€‚</p>
<ul>
<li>ä¸‹è½½åˆé€‚çš„ç‰ˆæœ¬ï¼ˆæˆ‘ä¸‹è½½çš„æ˜¯ <code>php-7.2.11-nts-Win32-VC15-x64.zip</code>ï¼‰ï¼›</li>
<li>è§£å‹è‡³ä½ å–œæ¬¢çš„ä½ç½®ï¼ˆæˆ‘æ”¾åœ¨ <code>E:\environment\php</code> é‡Œï¼‰ï¼›</li>
<li>å¤åˆ¶ä¸€ä»½ <code>php.ini-development</code>ï¼Œé‡å‘½åä¸º <code>php.ini</code> å¹¶é€‚å½“ä¿®æ”¹å…¶ä¸­é…ç½®ï¼›</li>
<li>ç›´æ¥åŒå‡»è¿è¡Œ <code>php.exe</code>ï¼›</li>
<li>å¦‚æœèƒ½æ­£å¸¸æ‰“å¼€ PHP Interactive Shellï¼Œå°±å¯ä»¥è¿›å…¥ä¸‹ä¸€æ­¥äº†ã€‚</li>
</ul>
<p><strong>å¦‚æœæ— æ³•è¿è¡Œï¼Œè¯·æ£€æŸ¥ä½ æ˜¯å¦å®‰è£…äº†å¯¹åº”çš„ VC è¿è¡Œåº“ã€‚</strong></p>
<p>æ¨èä¿®æ”¹çš„ <code>php.ini</code> é…ç½®å¦‚ä¸‹ï¼š</p>
<pre><code class="ini">; æ‰©å±•æ‰€åœ¨çš„ç›®å½•ï¼Œè‡ªè¡Œä¿®æ”¹
extension_dir = &quot;E:\environment\php\ext&quot;
; æŒ‰è‡ªå·±çš„éœ€æ±‚å¯ç”¨æ‰©å±•
extension=pdo_mysql
extension=...
; å„ç§ç¼“å­˜çš„ä½ç½®
sys_temp_dir = &quot;E:\environment\php\temp&quot;
upload_tmp_dir = &quot;E:\environment\php\temp&quot;
session.save_path = &quot;E:\environment\php\temp&quot;
; å…¶ä»–æ‚ä¸ƒæ‚å…«çš„
upload_max_filesize = 100M
date.timezone = Asia/Shanghai
</code></pre>
<h2 id="0x03-é…ç½®-FastCGI-è½¬å‘"><a href="#0x03-é…ç½®-FastCGI-è½¬å‘" class="headerlink" title="0x03 é…ç½® FastCGI è½¬å‘"></a>0x03 é…ç½® FastCGI è½¬å‘</h2><p>æ¥ä¸‹æ¥æ‰æ˜¯é‡å¤´æˆï¼Œæˆ‘ä»¬è¦è®© Web Server ä¸ PHP èƒ½å¤Ÿäº’ç›¸é€šä¿¡ä»¥å®Œæˆè¯·æ±‚ã€‚</p>
<p>ä½œä¸º Web Server çš„åç«¯æ—¶ï¼ŒPHP ä¸»è¦æœ‰ä¸¤ç§è¿è¡Œæ–¹å¼ï¼Œä¸€ç§æ˜¯ <strong>ç‹¬ç«‹è¿›ç¨‹ã€ä½¿ç”¨ <a href="http://www.nowamagic.net/librarys/veda/detail/1319" target="_blank" rel="noopener">FastCGI åè®®</a> ä¸ Web Server é€šä¿¡</strong>ï¼ˆNginx ç”¨çš„å°±æ˜¯è¿™ç§ï¼‰ï¼Œå¦å¤–ä¸€ç§æ˜¯ <strong>ä½œä¸ºæ¨¡å—ç›´æ¥åŠ è½½åˆ° Web Server ä¸­</strong>ï¼ˆæ¯”å¦‚ Apache çš„ <code>mod_php</code> æ¨¡å—ï¼Œä¸è¿‡ Apache ä¹Ÿæ”¯æŒ FastCGI æ–¹å¼ï¼‰ã€‚è¯¦ç»†çš„åŸç†æˆ‘å°±ä¸ä»‹ç»äº†ï¼Œæœ‰å…´è¶£çš„é€‰æ‰‹å¯ä»¥å»äº†è§£ä¸€ä¸‹ã€‚</p>
<p>ä¸ºäº†èƒ½å¤ŸåŒæ—¶å…¼å®¹ Nginx å’Œ Apacheï¼Œ<strong>æœ¬æ–‡å‡ä½¿ç”¨ FastCGI æ–¹å¼åŠ è½½ PHP</strong>ã€‚</p>
<hr>
<p>é¦–å…ˆæˆ‘ä»¬éœ€è¦é…ç½®ä¸€ä¸‹ PHP çš„ FastCGI è¿›ç¨‹ç®¡ç†å™¨ã€‚ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºç›´æ¥è¿è¡Œ PHP çš„ FastCGI è¿›ç¨‹ï¼ˆåœ¨ Windows ä¸Šå°±æ˜¯ <code>php-cgi.exe</code>ï¼‰æœ‰ä»¥ä¸‹ç¼ºç‚¹ï¼š</p>
<ul>
<li>é…ç½®æ–‡ä»¶ <code>php.ini</code> ä¿®æ”¹åæ— æ³•å¹³æ»‘é‡è½½ï¼Œéœ€è¦é‡æ–°å¯åŠ¨ <code>php-cgi</code> è¿›ç¨‹ï¼›</li>
<li>Windows ä¸‹ <code>php-cgi</code> é»˜è®¤å¤„ç† 500 ä¸ªè¯·æ±‚åå°±è‡ªåŠ¨é€€å‡ºï¼ˆ<code>PHP_FCGI_MAX_REQUESTS</code>ï¼‰ï¼›</li>
<li>å¦‚æœå› ä¸ºå…¶ä»–åŸå› é€ æˆ <code>php-cgi</code> è¿›ç¨‹å´©æºƒï¼Œå°±æ— æ³•å¤„ç†åç»­è¯·æ±‚äº†ã€‚</li>
</ul>
<p>æ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¸€ä¸ªç±»ä¼¼å®ˆæŠ¤è¿›ç¨‹çš„ä¸œè¥¿ï¼Œæ¥ä¿è¯å§‹ç»ˆæœ‰ä¸€å®šæ•°é‡çš„ <code>php-cgi</code> è¿›ç¨‹åœ¨è¿è¡Œã€‚<a href="http://php.net/manual/zh/install.fpm.php" target="_blank" rel="noopener">PHP-FPM</a> (PHP FastCGI Process Manager) æ˜¯ PHP å®˜æ–¹é’¦å®šçš„ FastCGI è¿›ç¨‹ç®¡ç†å™¨ï¼Œä½†é—æ†¾çš„æ˜¯ï¼Œå®ƒåªé€‚ç”¨äºç±» Unix ç³»ç»Ÿã€‚åœ¨ Windows ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™äº›æ›¿ä»£å“æ¥å®ç°ç±»ä¼¼çš„åŠŸèƒ½ï¼ˆ<strong>Apache ç”¨æˆ·ä¸éœ€è¦é…ç½®è¿™äº›ä¸œè¥¿</strong>ï¼Œå› ä¸ºå®ƒçš„ <code>mod_fcgid</code> æ¨¡å—è‡ªå¸¦ FastCGI è¿›ç¨‹ç®¡ç†åŠŸèƒ½ï¼‰ï¼š</p>
<ul>
<li><a href="https://github.com/78/xxfpm" target="_blank" rel="noopener">xxfpm</a></li>
<li><a href="https://github.com/deemru/php-cgi-spawner" target="_blank" rel="noopener">php-cgi-spawner</a></li>
<li><a href="https://github.com/lighttpd/spawn-fcgi" target="_blank" rel="noopener">spawn-fcgi</a></li>
</ul>
<p>æœ¬æ–‡å°†ä»¥ php-cgi-spawner ä¸ºä¾‹è¿›è¡Œé…ç½®ã€‚</p>
<ul>
<li><p>åœ¨ <a href="https://github.com/deemru/php-cgi-spawner/releases" target="_blank" rel="noopener">è¿™é‡Œ</a> ä¸‹è½½ç¼–è¯‘å¥½çš„ <code>php-cgi-spawner.exe</code>ï¼›</p>
</li>
<li><p>æ”¾åˆ° PHP çš„å®‰è£…ç›®å½•ä¸‹ï¼ˆæœ¬æ–‡ä¸º <code>E:\environment\php</code>ï¼‰ï¼›</p>
</li>
<li><p>æ‰“å¼€ PowerShell æˆ–è€… CMDï¼Œè¿è¡Œå‘½ä»¤ï¼š</p>
<pre><code class="powershell"># ä»¤ PHP FastCGI å¤„ç†ç¨‹åºç›‘å¬åœ¨ 9000 ç«¯å£ä¸Š
# è‡³å°‘å¼€å¯ 4 ä¸ª php-cgi è¿›ç¨‹ï¼Œé«˜è´Ÿè½½æ—¶æœ€å¤šå¯ä»¥å¼€åˆ° 16 ä¸ª
.\php-cgi-spawner.exe &quot;php-cgi.exe -c php.ini&quot; 9000 4+16
</code></pre>
</li>
<li><p>å¦‚æœä¸€åˆ‡æ­£å¸¸ï¼Œä½ å°†å¯ä»¥åœ¨ä»»åŠ¡ç®¡ç†å™¨ä¸­çœ‹åˆ°åŒæ—¶è¿è¡Œçš„å¤šä¸ª <code>php-cgi</code> è¿›ç¨‹ã€‚</p>
</li>
</ul>
<p><img src="https://img.blessing.studio/images/2018/11/01/php-cgi-processes.png" alt="php-cgi-processes"></p>
<p><strong>æ¥ä¸‹æ¥ä¿®æ”¹ Nginx é…ç½®</strong>ï¼ˆå³ 0x01 ä¸­æåˆ°çš„ <code>vhosts.conf</code> ä¸­çš„å†…å®¹ï¼‰ï¼Œé€šè¿‡ FastCGI åè®®å°†è¯·æ±‚è½¬å‘ç»™ç›‘å¬åœ¨ 9000 ç«¯å£ä¸Šçš„ PHP è¿›è¡Œå¤„ç†ï¼š</p>
<pre><code class="nginx">server {
    listen       80;
    server_name  localhost;
    root   E:/wwwroot;
    index  index.html index.htm index.php;

    location ~ [^/]\.php(/|$) {
        # ä» URI ä¸­åˆ†ç¦»å‡º $fastcgi_script_name å’Œ $fastcgi_path_info çš„å€¼
        # ä¸æ¨èä½¿ç”¨ php.ini ä¸­çš„ cgi.fix_pathinfo é€‰é¡¹ï¼Œè¿™å¯èƒ½ä¼šé€ æˆå®‰å…¨éšæ‚£
        # è™½ç„¶æˆ‘æ„Ÿè§‰ 8012 å¹´äº†åº”è¯¥æ²¡äººç”¨ PATH_INFO äº†â€¦â€¦ä¸éœ€è¦çš„è¯å»æ‰å³å¯
        fastcgi_split_path_info  ^(.+?\.php)(/.*)$;
        fastcgi_param  PATH_INFO  $fastcgi_path_info;

        # å½“è¯·æ±‚çš„ .php æ–‡ä»¶ä¸å­˜åœ¨æ—¶ç›´æ¥è¿”å› 404
        # ä¸ç„¶äº¤ç»™ PHP å¤„ç†çš„è¯é‚£è¾¹å°±ä¼šè¿”å› No input file specified.
        if (!-f $document_root$fastcgi_script_name) {
            return 404;
        }

        fastcgi_pass   127.0.0.1:9000;
        fastcgi_index  index.php;
        # è‡ªå¸¦çš„é…ç½®æ–‡ä»¶ï¼Œé‡Œé¢è®¾ç½®äº†ä¸€å¤§å † CGI åè®®ä¸­çš„å˜é‡
        include        fastcgi.conf;
    }
}
</code></pre>
<hr>
<p><strong>Apache ç”¨æˆ·ä¸éœ€è¦æ‰‹åŠ¨é…ç½® PHP FastCGI è¿›ç¨‹ç®¡ç†å™¨ï¼Œç›¸å¯¹ç®€å•ä¸€äº›ï¼š</strong></p>
<ul>
<li>åœ¨ä¸Šé¢æåˆ°çš„ <a href="https://www.apachelounge.com/download/" target="_blank" rel="noopener">Apache Lounge</a> ä¸Šä¸‹è½½ç¼–è¯‘å¥½çš„ <code>mod_fcgid</code> æ¨¡å—ï¼›</li>
<li>è§£å‹åï¼Œå°† <code>mod_fcgid.so</code> æ”¾å…¥ Apache çš„ <code>modules</code> ç›®å½•ï¼›</li>
<li>ç¼–è¾‘é…ç½®æ–‡ä»¶åŠ è½½æ¨¡å—ï¼ˆå³ 0x01 ä¸­æåˆ°çš„ <code>conf/extra/httpd-php.conf</code>ï¼‰ï¼š</li>
</ul>
<pre><code class="apache"># å¦‚æœå«Œéº»çƒ¦çš„è¯è¿™ä¸€æ®µä¹Ÿå¯ä»¥ç›´æ¥æ”¾åˆ° httpd.conf é‡Œé¢å»
LoadModule fcgid_module modules/mod_fcgid.so

&lt;IfModule fcgid_module&gt;
FcgidInitialEnv PHPRC &quot;E:/environment/php/&quot;
FcgidInitialEnv PHP_FCGI_MAX_REQUESTS 1000
AddHandler fcgid-script .php
FcgidWrapper &quot;E:/environment/php/php-cgi.exe&quot; .php
FcgidIOTimeout 384
FcgidConnectTimeout 360
FcgidOutputBufferSize 128
FcgidMaxRequestsPerProcess 1000
FcgidMinProcessesPerClass 0
FcgidMaxProcesses 16
FcgidMaxRequestLen 268435456
ProcessLifeTime 360
&lt;/IfModule&gt;
</code></pre>
<ul>
<li>ç¼–è¾‘ <code>conf/vhosts.conf</code> å…è®¸è¿è¡Œ CGI ç¨‹åºï¼š</li>
</ul>
<pre><code class="apache">&lt;VirtualHost localhost:80&gt;
  DocumentRoot &quot;E:\wwwroot&quot;
  &lt;Directory &quot;E:\wwwroot&quot;&gt;
    DirectoryIndex index.html index.php
    # æ³¨æ„è¿™é‡Œçš„ +ExecCGIï¼Œä¸åŠ çš„è¯ä¼š 403
    Options -Indexes -FollowSymLinks +ExecCGI
    AllowOverride All
    Order allow,deny
    Allow from all
    Require all granted
  &lt;/Directory&gt;
&lt;/VirtualHost&gt;
</code></pre>
<p>å¦‚æœä¸€åˆ‡é…ç½®æ­£ç¡®ï¼Œä½ åº”è¯¥å°±èƒ½æ­£å¸¸è®¿é—® PHP ç½‘é¡µäº†ã€‚</p>
<p><img src="https://img.blessing.studio/images/2018/11/01/nginx-php-works.png" alt="nginx-php-works"></p>
<h2 id="0x04-ç¼–å†™å¯åœè„šæœ¬"><a href="#0x04-ç¼–å†™å¯åœè„šæœ¬" class="headerlink" title="0x04 ç¼–å†™å¯åœè„šæœ¬"></a>0x04 ç¼–å†™å¯åœè„šæœ¬</h2><p>è™½ç„¶æ•´ä¸ªç³»ç»Ÿæ˜¯è·‘èµ·æ¥äº†ï¼Œä½†æ€»ä¸èƒ½æ¯æ¬¡å¯åŠ¨éƒ½å¾—å¼€ä¸€å¤§å †æ§åˆ¶å°çª—å£å§ï¼Ÿå¼„ä¸ªå°å·¥å…·ç®¡ç† Nginx/Apache å’Œ PHP çš„è¿›ç¨‹è¿˜æ˜¯å¾ˆæœ‰å¿…è¦çš„ã€‚å„ç§ä¸€é”®åŒ…ä¸­ä¸€èˆ¬éƒ½è‡ªå¸¦äº†æ–¹ä¾¿å¥½ç”¨çš„ç•Œé¢æ¥ç®¡ç†è¿™äº›è¿›ç¨‹ï¼Œä¸è¿‡æ—¢ç„¶æˆ‘ä»¬é€‰æ‹©äº†æ‰‹åŠ¨é…ç½®ï¼Œé‚£è¿™ä¸€å—ä¹Ÿå¾—æˆ‘ä»¬è‡ªå·±æå®šäº†ã€‚å› ä¸ºå›¾æ–¹ä¾¿ï¼Œæˆ‘é€‰æ‹©ä½¿ç”¨ Windows çš„æ‰¹å¤„ç†è„šæœ¬ï¼ˆBatch Fileï¼‰æ¥å®Œæˆè¿™é¡¹éœ€æ±‚ï¼Œä¿å­˜ä¸º <code>.bat</code> æ–‡ä»¶åŒå‡»è¿è¡Œå°±å®Œäº‹å„¿äº†ã€‚</p>
<p><strong>å¯åŠ¨ Nginx å’Œ PHPï¼š</strong></p>
<pre><code class="cmd">@ECHO OFF
set nginx_home=..\nginx
set php_home=..\php

ECHO Starting PHP FastCGI...
.\RunHiddenConsole.exe %php_home%\php-cgi-spawner.exe &quot;%php_home%\php-cgi.exe -c %php_home%\php.ini&quot; 9000 4+16

ECHO Starting Nginx...
.\RunHiddenConsole.exe %nginx_home%\nginx.exe -p %nginx_home%
</code></pre>
<p><strong>åœæ­¢ Nginx å’Œ PHPï¼š</strong></p>
<pre><code class="cmd">@ECHO OFF

ECHO Stopping nginx...
taskkill /F /IM nginx.exe &gt; nul

ECHO Stopping PHP FastCGI...
taskkill /F /IM php-cgi-spawner.exe &gt; nul
taskkill /F /IM php-cgi.exe &gt; nul
</code></pre>
<p><strong>é‡è½½ Nginx é…ç½®ï¼š</strong></p>
<pre><code class="cmd">@ECHO OFF
set nginx_home=..\nginx

ECHO Reloading Nginx...
%nginx_home%\nginx.exe -s reload
</code></pre>
<p><strong>å¯åŠ¨ Apache</strong>ï¼ˆApache ä¼šå¸®æˆ‘ä»¬å¯åŠ¨ PHP çš„ï¼‰ï¼š</p>
<pre><code class="cmd">@ECHO OFF
set apache_home=..\apache

ECHO Starting Apache Httpd...
.\RunHiddenConsole.exe %apache_home%\bin\httpd.exe
</code></pre>
<p><strong>åœæ­¢ Apacheï¼š</strong></p>
<pre><code class="cmd">@ECHO OFF

ECHO Stopping Apache Httpd...
taskkill /F /IM httpd.exe &gt; nul
</code></pre>
<p>è¿™äº›è„šæœ¬æˆ‘æ”¾åœ¨ <code>E:\environment\scripts</code> ç›®å½•ä¸­ï¼Œå¦‚æœä½ éœ€è¦æ”¾åœ¨å…¶ä»–åœ°æ–¹ï¼Œè¯·é€‚å½“ä¿®æ”¹è„šæœ¬ä¸­çš„å¯æ‰§è¡Œæ–‡ä»¶è·¯å¾„ã€‚å¦å¤–ï¼Œè„šæœ¬ä¸­ç”¨åˆ°äº† <code>RunHiddenConsole.exe</code> æ¥éšè—å‘½ä»¤è¡Œçª—å£ï¼Œä½ å¯ä»¥åœ¨ <a href="http://redmine.lighttpd.net/attachments/660/RunHiddenConsole.zip" target="_blank" rel="noopener">è¿™é‡Œ</a> ä¸‹è½½åˆ°è¿™ä¸ªå°å·¥å…·ã€‚</p>
<p><img src="https://img.blessing.studio/images/2018/11/01/wnmp-all-processes.png" alt="wnmp-all-processes"></p>
<h2 id="0x05-åè®°"><a href="#0x05-åè®°" class="headerlink" title="0x05 åè®°"></a>0x05 åè®°</h2><p>é…ç½®å®Œæˆåçš„ç›®å½•ç»“æ„å¤§æ¦‚æ˜¯è¿™æ ·çš„ï¼ˆæœ‰çœç•¥ï¼‰ï¼š</p>
<pre><code class="text">E:\environment&gt; tree
.
â”œâ”€â”€ apache
â”‚   â”œâ”€â”€ bin
â”‚   â”œâ”€â”€ cgi-bin
â”‚   â”œâ”€â”€ conf
â”‚   â”‚   â”œâ”€â”€ extra
â”‚   â”‚   â”œâ”€â”€ original
â”‚   â”‚   â”œâ”€â”€ charset.conv
â”‚   â”‚   â”œâ”€â”€ httpd.conf *
â”‚   â”‚   â”œâ”€â”€ magic
â”‚   â”‚   â”œâ”€â”€ mime.types
â”‚   â”‚   â”œâ”€â”€ openssl.cnf
â”‚   â”‚   â””â”€â”€ vhosts.conf *
â”‚   â”œâ”€â”€ include
â”‚   â”œâ”€â”€ lib
â”‚   â”œâ”€â”€ logs
â”‚   â””â”€â”€ modules
â”œâ”€â”€ mysql
â”‚   â”œâ”€â”€ bin
â”‚   â”œâ”€â”€ data
â”‚   â”œâ”€â”€ include
â”‚   â”œâ”€â”€ lib
â”‚   â””â”€â”€ share
â”œâ”€â”€ nginx
â”‚   â”œâ”€â”€ conf
â”‚   â”‚   â”œâ”€â”€ fastcgi.conf
â”‚   â”‚   â”œâ”€â”€ fastcgi_params
â”‚   â”‚   â”œâ”€â”€ koi-utf
â”‚   â”‚   â”œâ”€â”€ koi-win
â”‚   â”‚   â”œâ”€â”€ mime.types
â”‚   â”‚   â”œâ”€â”€ nginx.conf *
â”‚   â”‚   â”œâ”€â”€ scgi_params
â”‚   â”‚   â”œâ”€â”€ uwsgi_params
â”‚   â”‚   â”œâ”€â”€ vhosts.conf *
â”‚   â”‚   â””â”€â”€ win-utf
â”‚   â”œâ”€â”€ contrib
â”‚   â”œâ”€â”€ logs
â”‚   â””â”€â”€ nginx.exe
â”œâ”€â”€ php
â”‚   â”œâ”€â”€ dev
â”‚   â”œâ”€â”€ ext
â”‚   â”œâ”€â”€ extras
â”‚   â”œâ”€â”€ lib
â”‚   â”œâ”€â”€ sasl2
â”‚   â”œâ”€â”€ temp
â”‚   â”œâ”€â”€ ...
â”‚   â”œâ”€â”€ php7.dll
â”‚   â”œâ”€â”€ php-cgi.exe
â”‚   â”œâ”€â”€ php-cgi-spawner.exe *
â”‚   â”œâ”€â”€ php.exe
â”‚   â””â”€â”€ php.ini *
â””â”€â”€ scripts
    â”œâ”€â”€ reload-nginx.bat
    â”œâ”€â”€ restart-nginx.bat
    â”œâ”€â”€ RunHiddenConsole.exe
    â”œâ”€â”€ start-all.bat
    â”œâ”€â”€ start-apache.bat
    â”œâ”€â”€ start-mysql.bat
    â”œâ”€â”€ start-nginx.bat
    â”œâ”€â”€ stop-all.bat
    â”œâ”€â”€ stop-apache.bat
    â”œâ”€â”€ stop-mysql.bat
    â””â”€â”€ stop-nginx.bat
</code></pre>
<p>éå¸¸æ¸…çˆ½ï¼Œæœ‰ç§ä¸€åˆ‡å°½åœ¨æŒæ§ä¸­çš„æ„Ÿè§‰ï¼Œæˆ‘å–œæ¬¢ã€‚</p>
<p>å¦‚æœä½ æ˜¯ä¸€å PHP å¼€å‘è€…ï¼Œå´ä»æ¥æ²¡æœ‰æ‰‹åŠ¨é…ç½®è¿‡ PHP ç¯å¢ƒçš„è¯ï¼Œé‚£æˆ‘å»ºè®®ä½ å°è¯•ä¸€ä¸‹ã€‚è™½ç„¶ç”Ÿäº§ç¯å¢ƒä¸Šä¸€èˆ¬éƒ½æ˜¯é‡‡ç”¨æˆç†Ÿçš„ä¸€é”®åŒ…ï¼Œä¸è¿‡æ‰‹åŠ¨é…ç½®ä¸€ä¸‹è¿™ä¸€å¥—ä¸œè¥¿å¯ä»¥æ›´æ·±å…¥åœ°äº†è§£ PHP ä¸ Web Server çš„åä½œæœºåˆ¶ï¼Œè¿™å¯¹äºç¼–å†™ä¸Šå±‚åº”ç”¨ä»¥åŠè¿ç»´ä¹Ÿæ˜¯å¾ˆæœ‰å¥½å¤„çš„ã€‚</p>
<p>æœ¬æ¥æƒ³é¡ºå¸¦å‡‘é½ä¸€å¥— WNMPï¼Œä½†æ˜¯ MySQL çš„å®‰è£…é…ç½®ç›¸å¯¹æ¯”è¾ƒç®€å•ï¼Œè€Œä¸”ä¹Ÿä¸åƒ PHP ä¸ Web Server é‚£æ ·è€¦åˆç´§å¯†ï¼Œæ‰€ä»¥è¿™é‡Œå°±æŒ‰ä¸‹ä¸è¡¨ã€‚</p>
<p>ä»¥ä¸Šã€‚</p>

      <div class="post-about"><p>é™¤å¦æœ‰å£°æ˜å¤–ï¼Œæœ¬åšå®¢æ–‡ç« å‡é‡‡ç”¨ <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/">çŸ¥è¯†å…±äº«(Creative Commons) ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç›¸åŒæ–¹å¼å…±äº« 3.0 ä¸­å›½å¤§é™†è®¸å¯åè®®</a> è¿›è¡Œè®¸å¯ã€‚</p></div>
    </div>

    <div class="post-meta clf">
  <span class="pmt pms fa-book">
    
      <a class="category-link" href="/categories/tech/">æŠ€æœ¯</a>
    
  </span>
  <span class="pmt pms fa-clock-o">2018-11-01</span>
  <span class="pmt pms fa-eye">
    <span id="post-view" data="setup-nginx-php-on-windows/">Loading</span> Hits
  </span>
  <span class="pmt pms extra fa-tag">
    
      <a class="tag-link" href="/tag/Apache/">Apache</a>, <a class="tag-link" href="/tag/Nginx/">Nginx</a>, <a class="tag-link" href="/tag/PHP/">PHP</a>
    
  </span>
</div>

  </article>

  
    <div class="disqus"></div>

<p class="disqus-notice hentry"  style="display: none;">
  <i class="fa fa-spinner fa-spin" aria-hidden="true"></i>  å¦‚æœè¯„è®ºæ¡†åŠ è½½ä¸å‡ºæ¥ï¼Œé‚£å°±è¯´æ˜ Disqus è¢«å¢™äº†ï¼Œä½ çœ‹ç€åŠå§ |ãƒ¼` )
</p>

  

        </div>

        <div id="sidebar" class="fl">

  <div id="abovesb">
    <div class="card">
      <div class="gr center">
        <p id="music-toggle">
          <i class="fa fa-play-circle" aria-hidden="true"></i>
        </p>
        <img src="/images/avatar.jpg" width="112" height="112">
      </div>

      <div class="blogname">Blessing Studio</div>
      <div class="blogdesc">åŠåŠå­å…¨æ ˆå¼€å‘è€…çš„æ—¥å¸¸</div>

      <div class="sbmenu">
        <div class="menu-container">
          <ul class="menu">
  
    
    <li class="menu-item menu-item-friends">
      <a href="/friends" title="å‹æƒ…é“¾æ¥" rel="section">
        <i class="fa fa-link"></i>æˆ‘çš„å°ä¼™ä¼´ä»¬
      </a>
    </li>
  
    
    <li class="menu-item menu-item-about">
      <a href="/about" title="(*ï¾Ÿâˆ€ï¾Ÿ*)" rel="section">
        <i class="fa fa-code"></i>å…³äºæˆ‘
      </a>
    </li>
  
</ul>

        </div>
      </div>
    </div>
    
    <div id="music-player" class="aplayer hide rotated"></div>
  </div>

  <script type="text/javascript">nanobar.go(40);</script>

  <div id="sb">
    
<div id="sbpin">
  
  
  <div class="clf widget-item widget-toc">
    <h3 class="widget-title">æ–‡ç« ç›®å½•</h3>
    <div class="textwidget">
      <div class="toc-container">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#0x01-å®‰è£…-Nginx-Apache"><span class="toc-text">0x01 å®‰è£… Nginx / Apache</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x02-å®‰è£…-PHP"><span class="toc-text">0x02 å®‰è£… PHP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x03-é…ç½®-FastCGI-è½¬å‘"><span class="toc-text">0x03 é…ç½® FastCGI è½¬å‘</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x04-ç¼–å†™å¯åœè„šæœ¬"><span class="toc-text">0x04 ç¼–å†™å¯åœè„šæœ¬</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x05-åè®°"><span class="toc-text">0x05 åè®°</span></a></li></ol>
      </div>
    </div>
  </div>
  

  
  <div class="clf widget-item widget_text">
    <div class="textwidget">
      <script type="text/javascript" src="https://work.prinzeugen.net/hitokoto/hitokoto.php?encode=javascript"></script>
      <p id="hitokoto"><script>hitokoto();</script></p>
    </div>
  </div>

  
  

</div>

  </div>

</div>

      </div><!-- #container -->

      <div id="foot" class="fw">
        <div id="bottom" class="fw">
  <div id="footer" class="wc center clf">
    <div class="info">
      <p>Copyleft 2018 <a href="https://blessing.studio">Blessing Studio</a>. Proudly published with <a href="https://hexo.io/" target="_blank">Hexo</a>. Made with â¤ by printempw.</p>
    </div>
  </div>
</div>

      </div>

    </div><!-- #pageframe.fw -->
    <script type="text/javascript">nanobar.go(80);</script>

    <div class="back-to-top">
      <span class="fa fa-angle-up"></span>
    </div>

    <script src="/js/jquery-2.2.0.min.js"></script>
<script src="/js/jquery.libs.js"></script>
<script src="/js/highlight.min.js"></script>
<script src="/libs/fancybox/source/jquery.fancybox.pack.js"></script>
<script src="/js/script.js"></script>

    
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-65656002-1', 'auto');
  ga('send', 'pageview');

</script>


    <script type="text/javascript">
    $("a.like-vote").mouseover(function() {
        $("#heart").removeClass("fa-heart-o");
        $("#heart").addClass("fa-heart");
    });

    $("a.like-vote").mouseout(function() {
        $("#heart").removeClass("fa-heart");
        $("#heart").addClass("fa-heart-o");
    });

    $.getJSON("//work.prinzeugen.net/do-you-like-me/like.php?action=get", function (data) {
        $('#count').html(data.like);
    });

    $('.like-vote').click(function () {
        if ($('.like-title').html() === 'Do you like me ?') {
            $.getJSON("//work.prinzeugen.net/do-you-like-me/like.php?action=add", function (data) {
                if (data.success) {
                    $('#count').fadeOut(200);
                    $('#count').html(String(parseInt(data.like)));
                    $('#count').fadeIn(200);
                    $('.like-title').html('æˆ‘ä¹Ÿå–œæ¬¢ä½  (*â‰§â–½â‰¦)');
                }
                else {
                    $('.like-title').html('ä½ çš„çˆ±æˆ‘å·²ç»æ„Ÿå—åˆ°äº†~');
                }
            });
        }
    });
</script>

    <style type="text/css">
    .menu-item-kaomoji a {
        -moz-user-select: none;
        -webkit-user-select: none;
        -ms-user-select: none;
    }

    .info-rise {
        z-index: 99999;
        position: absolute;
        padding: 0 4px;
        border-radius: 1px;
        background-color: #f69;
        box-shadow: 0 0 1px rgba(0,0,0,0.1);
        color: #fff;
        text-align: center;
        font-size: 12px;
        line-height: 1.5;
        cursor: default
    }
</style>

<script type="text/javascript">
    var kaomoji_array = ["|âˆ€ï¾Ÿ", "(Â´ï¾ŸĞ”ï¾Ÿ`)", "(;Â´Ğ”`)", "(ï½€ï½¥Ï‰ï½¥)", "(=ï¾ŸÏ‰ï¾Ÿ)=", "| Ï‰ãƒ»Â´)", "|-` )", "|Ğ´` )", "|ãƒ¼` )", "|âˆ€` )", "(ã¤Ğ´âŠ‚)", "(ï¾ŸĞ”ï¾Ÿâ‰¡ï¾ŸĞ”ï¾Ÿ)", "(ï¼¾oï¼¾)ï¾‰", "(|||ï¾ŸĞ”ï¾Ÿ)", "( ï¾Ÿâˆ€ï¾Ÿ)", "( Â´âˆ€`)", "(*Â´âˆ€`)", "(*ï¾Ÿâˆ‡ï¾Ÿ)", "(*ï¾Ÿãƒ¼ï¾Ÿ)", "(ã€€ï¾Ÿ 3ï¾Ÿ)", "( Â´ãƒ¼`)", "( ãƒ»_ã‚ãƒ»)", "( Â´_ã‚`)", "(*Â´Ğ´`)", "(ãƒ»ãƒ¼ãƒ»)", "(ãƒ»âˆ€ãƒ»)", "(ã‚âˆ€ï½¥)", "(ã€ƒâˆ€ã€ƒ)", "(*ï¾Ÿâˆ€ï¾Ÿ*)", "( ï¾Ÿâˆ€ã€‚)", "( `Ğ´Â´)", "(`ÎµÂ´ )", "(`ãƒ®Â´ )", "Ïƒ`âˆ€Â´)", " ï¾Ÿâˆ€ï¾Ÿ)Ïƒ", "ï¾Ÿ âˆ€ï¾Ÿ)ãƒ", "(â•¬ï¾ŸĞ´ï¾Ÿ)", "(|||ï¾ŸĞ´ï¾Ÿ)", "( ï¾ŸĞ´ï¾Ÿ)", "Î£( ï¾ŸĞ´ï¾Ÿ)", "( ;ï¾ŸĞ´ï¾Ÿ)", "( ;Â´Ğ´`)", "(ã€€Ğ´ ) ï¾Ÿ ï¾Ÿ", "( â˜‰Ğ´âŠ™)", "(((ã€€ï¾ŸĞ´ï¾Ÿ)))", "( ` ãƒ»Â´)", "( Â´Ğ´`)", "( -Ğ´-)", "(>Ğ´<)", "ï½¥ï¾Ÿ( ï¾‰Ğ´`ï¾Ÿ)", "( TĞ´T)", "(ï¿£âˆ‡ï¿£)", "(ï¿£3ï¿£)", "(ï¿£ï½°ï¿£)", "(ï¿£ . ï¿£)", "(ï¿£çš¿ï¿£)", "(ï¿£è‰¸ï¿£)", "(ï¿£ï¸¿ï¿£)", "(ï¿£ï¸¶ï¿£)", "ãƒ¾(Â´Ï‰ï¾Ÿï½€)", "(*Â´Ï‰`*)", "(ãƒ»Ï‰ãƒ»)", "( Â´ãƒ»Ï‰)", "(ï½€ãƒ»Ï‰)", "(Â´ãƒ»Ï‰ãƒ»`)", "(`ãƒ»Ï‰ãƒ»Â´)", "( `_ã£Â´)", "( `ãƒ¼Â´)", "( Â´_ã£`)", "( Â´Ï`)", "( ï¾ŸÏ‰ï¾Ÿ)", "(oï¾ŸÏ‰ï¾Ÿo)", "(ã€€^Ï‰^)", "(ï½¡â—•âˆ€â—•ï½¡)", "/( â—•â€¿â€¿â—• )\\", "ãƒ¾(Â´Îµ`ãƒ¾)", "(ãƒï¾Ÿâˆ€ï¾Ÿ)ãƒ", "(Ïƒï¾ŸĞ´ï¾Ÿ)Ïƒ", "(Ïƒï¾Ÿâˆ€ï¾Ÿ)Ïƒ", "|Ğ´ï¾Ÿ )", "â”ƒé›»æŸ±â”ƒ", "ï¾Ÿ(ã¤Ğ´`ï¾Ÿ)", "ï¾Ÿâ„«ï¾Ÿ )ã€€", "âŠ‚å½¡â˜†))Ğ´`)", "âŠ‚å½¡â˜†))Ğ´Â´)", "âŠ‚å½¡â˜†))âˆ€`)", "(Â´âˆ€((â˜†ãƒŸã¤"];
    var hits = 0;
    var start_time = 0;

    $('.menu-item-kaomoji a').click(function(e) {

        if (start_time == 0) start_time = Date.now();

        hits ++;

        if (hits % 5 === 0) {
            index = Math.floor(Math.random() * kaomoji_array.length);
            $(this).html(kaomoji_array[index]);
        }

        x = $(this).offset().left + $(this).width();
        y = $(this).offset().top + $(this).height();

        if (hits % 50 === 0) {
            var duration = 2000;
            // actions per minite
            var apm = parseInt(hits / ((Date.now() - start_time) / 1000) * 60);
            start_time = 0;
            hits = 0;
            hit = $('<span class="info-rise" style="border: 1px solid #ffd6e4;font-size:13.5px;z-index:9999999;">æ‰‹é€Ÿï¼š'+apm+' actions/min </span>');

            console.log('APM: '+apm);
        } else {
            var duration = 500;
            hit = $('<span class="info-rise">+1</span>');
        }

        hit.appendTo($("body"));

        hit.css({
            opacity: 0,
            left: x,
            top: y
        }).animate({
            opacity: 1,
            top: y - 16
        }, 250).animate({
            opacity: 1,
            top: y - 20
        }, duration).animate({
            top: y - 20
        }, duration).animate({
            opacity: 0,
            top: y - 32
        }, 250, function() {
            return $(this).remove();
        });

    });
</script>

    <style type="text/css">
    .p-load-gist {
        margin: 25px 0 25px !important;
        text-align: center;
    }
</style>

<script type="text/javascript">
    $('.load-gist').on('click', function() {
        var gist = {
            url: '//work.prinzeugen.net/gist/printempw/' + $(this).data('hash') + '.json?callback=?',
            dom: this
        };

        $.getJSON(gist.url, function(data) {
            gist.style      = document.createElement('link');
            gist.style.type = 'text/css';
            gist.style.rel  = 'stylesheet';
            gist.style.href = data.stylesheet;

            document.getElementsByTagName('HEAD')[0].appendChild(gist.style);

            $(gist.dom).after(data.div).remove();
        });
    });
</script>

    <script type="text/javascript">
    String.prototype.cleanSlug = function () {
        var search = '/index.html';

        if (this.indexOf(search) === -1) {
            return this.slice(0, -1)
        } else {
            return this.replace(search, '');
        }
    }

    var Counter = function (url) {
        this.baseCounterUrl = url;

        this.initAllPostViews = function () {
            var self = this;

            // éå† post-view
            $('[id=post-view]').each(function () {
                // é»˜è®¤ PV è®¾ä¸º 0
                var span = $(this).html(0);
                var slug = span.attr('data').cleanSlug();

                self.getPostViewBySlug(slug, function (pv) {
                    span.html(pv);
                })
            });
        }

        this.getPostViewBySlug = function (slug, callback) {
            var url = this.baseCounterUrl + '/get/' + slug;

            $.getJSON(url, function (data) {
                callback(data.pv);
            });
        }

        this.incPostViewBySlug = function (slug) {
            var url = this.baseCounterUrl + '/increase/' + slug;

            $.post(url, {}, function (data) {
                $('#post-view').html(data.pv);
            });
        }
    }

    var counter = new Counter('https://work.prinzeugen.net/hexo-view-counter');

    $(document).ready(function () {
        counter.initAllPostViews();
    });
</script>


<script type="text/javascript">
    counter.incPostViewBySlug(
        $('#post-view').attr('data').cleanSlug()
    );
</script>


    <script src="/js/APlayer.min.js"></script>
<script type="text/javascript">
    var player = undefined;

    $.getJSON('https://work.prinzeugen.net/music/play_list.json', function (json) {
        // APlayer.addMusic sucks
        // And APlayer does not provide any method to remove
        // the automatically added music [undefined]
        player = new APlayer({
            element: document.getElementById('music-player'),
            narrow: false,
            autoplay: false,
            showlrc: false,
            mutex: true,
            preload: 'none',
            theme: '#367FA9',
            music: json
        });

        console.log('Music player initialized', json);
    });

    $('#music-toggle').click(function () {
        if (player === undefined) {
            return;
        }

        $('.card').addClass('rotated').addClass('hide');

        // I don't know why APlayer 1.6.0 tends to
        // attach "height: 0px" style to .aplayer-list automatically
        $('.aplayer-list').removeAttr('style')

        $('#music-player').removeClass('hide');

        $('#abovesb').css('padding', 0);

        setTimeout(function () {
            $('#music-player').removeClass('rotated');
        }, 10);
    });

    $('body').on('click', '.aplayer-icon-menu', function () {
        $('.aplayer-list').removeClass('aplayer-list-hide');

        $('#music-player').addClass('rotated').addClass('hide');

        $('.card').removeClass('hide');

        setTimeout(function () {
            $('.card').removeClass('rotated');
        }, 10);

        $('#abovesb').css('padding', '7px 0 1px');
    });
</script>


    
  <script src="/js/jquery.disqusloader.js"></script>

<script type="text/javascript">
  $.disqusLoader('.disqus', {
    scriptUrl: '//blessing-studio.disqus.com/embed.js',
    laziness: 0,
    preLoadCallback: function () {
        $('.disqus-notice').show()
    },
    disqusConfig: function () {
      this.callbacks.onReady = [function () {
        $('.disqus-notice').hide()
      }];
    }
  });
</script>



    <script type="text/javascript">nanobar.go(100);</script>
  </body>
</html>
